```dockerfile
                > 애플리케이션 배포를 위한 고급 설정 
            1. 포드의 자원 사용량 제한
    쿠버네티스와 같은 컨테이너 오케스트레이션 툴의 가장 큰 장점 중 하나는 여러 대의 서버를 묶어서 리소스 풀로 사용할 수 있다는 것이다. 클러스터의 CPU나
    메모리 등의 자원이 부족할 떄 필요한 용량만큼 서버를 동적으로 추가함으로써 수평적으로 확장할 수 있기 떄문이다. 하지만 서버를 수평적으로 늘리는 스케일 아웃
    (scale-out) 만큼 중요한 작업이 하나 이다. 바로 클러스터 내부에서 컴퓨팅 자원 활용률(Utilization)을 늘리는 것이다.
    
    자원 활용률은 서버 클러스터에서 자원을 얼마나 효율적으로 빠짐없이 사용하고 있는지를 의미한다. 예를 들어 쿠버네티스에서 실행 중인 컨테이너의 CPU, 메모리
    사용량이 현저히 낮거나 유휴 상태의 컨테이너에게 과잉 할당을 했다면 이를 자원 활용률이 낮다고 표현한다. 이러한 상황을 방지하기 위해서 각 컨테이너에
    적절한 자원 사용량을 제한해야하며, 남는 자원을 사용할 수 있는 전략을 세워야 한다. 
    
    쿠버네티스는 컴퓨팅 자원을 컨테이너에 할당하기 위한 여러 기능을 제공한다. 이번 장에서는 포드나 컨테이너에 CPU, 메모리 등의 자원을 할당하는 기본 방법을
    먼저 알아본 후, 쿠버네티스의 자원 활용률을 높이기 위한 오버커밋(Overcommit) 방법을 알아본다. 그 후 ResourceQuota, LimitRange라는 쿠버네티스 
    오브젝트를 알아본다.
    
            > 1.1 컨테이너와 포드의 자원 사용량 제한 : Limits
    쿠버네티스에서 자원을 할당하는 방법을 알아보기 전 도커 컨테이너의 자원 제한을 다시 상기시켜보자. 컨테이너의 자원 사용량을 제한하는 방법은 여러 가지가 있지만
    '--memory', '--cpu', '--cpu-shares', '--cpu-quota' 및 '--cpu-runtime' 등이 있다. '--memory' 옵션은 컨테이너가 사용 가능한 최대
    메모리 사용량을 제한하며, 그외의 옵션들의 CPU의 사용량을 제한한다. 이 중에서 '--cpu-shares'는 정량적인 CPU 할당량이 아닌 비율 값을 사용한다는
    점에서 특별한 옵션이었다. 
    
        'docker run -it --name memory_1gb --memory 1g ubuntu:16.04'
        'docker run -it --name cpu_1_alloc --cpus 1 ubuntu:16.04'
        'docker run -it --name cpu_shares_example --cpu-shares 1024 ubuntu:16.04'
    
    또는 다음관 같이 자원 제한 옵션을 설정하기 않고 도커 컨테이너를 생성하면 호스트의 모든 CPU, 메모리를 사용할 수 있었다.
    
        'docker run -it --name unlimited_blade unbuntu:16.04'
    
    쿠버네티스는 기본적으로 도커를 컨테이너 런타임으로 사용하기 때문에 포드를 생성할 때 docker와 동일한 원리로 CPu, 메모리 최대 사용량을 제한할 수 있다.
    그렇지만 지금까지 포드나 디플로이먼트 등을 생성할 때 자원 할당량을 명시적으로 제한했던 적이 없다는 것을 눈치챘을 것이다. 이처럼 자원 할당량을 설정하지 
    않으면 포드의 컨테이너가 노드의 물리 자원을 모두 사용할 수 있기 때문에 노드의 자원이 모두 고갈되는 상황이 발생할 수 있다. 
    
    이 예방할 수 있는 가장 간단한 방법은 포드 자체에 자원 사용량을 명시적으로 설정하는 것이다. 포드의 CPU, 메모리 사용량을 제한하기 위해 아래 내용으로 
    YAML을 작성해보자.
```
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: resource-limit-pod
  labels:
    name: resource-limit-pod
spec:
  containers:
  - name: nginx
    image: nginx:latest
  resources:
    limits:
      memory: '256Mi'
      cpu: '1000m'
```
```dockerfile
    포드를 정의하는 스펙에 새롭게 spec.containers.resources.limits 항목을 정의했다. 메모리는 256를 입력했는데, 이 설정값은 도커 명령어에서
    'docker run --memory 256m'과 같다. 즉 이 포드의 컨테이너 최대 메모리 사용량은 256Mi으로 제한된다. 
    cpu에는 1개의 cpu를 뜻하는 1000m(밀리코어)라는 값을 입력했으며, 이는 도커 명령에서 'docker run --cpus 1'와 같다. 따라서 이 포드의 컨테이너는
    최대 1개 CPU 만큼의 사이클을 사용할 수 있다. 
    
        {
            이전에 포드에는 여러 개의 컨테이너가 존재할 수 있다. 따라서 하나의 포드에 여러 개의 컨테이너가 할당돼 있다면 각 컨테이너에 대해
            자원을 각각 할당할 수 있다. 
        }
        
    위 내용으로 YAML을 작성한 후 포드를 생성하면 'kubectl apply -f resource-limit-pod.yaml'
    
    'docker info' 명령어로 도커 호스트의 가용 자원을 확인할 수 있던 것처럼 쿠버네티스에서도 'kubectl describe node' 명령어로 워커 노드의 가용 자원을
    간단하게 확인할 수 있다. 이를 위해 방금 생성한 포드가 어느 노드에 생성돼 있는지 먼저 확인한 다음, 'kubectl describe' 명령어로 해당 노드의 자세한
    정보를 확인한다.
    
        'kubectl get pods -o wide'
        'kubectl descrbie node [NODE....]'
        
    'kubectl describe node' 명령어의 출력 내용 중에서 중간 부분에 위치한 Non-terminated Pods 항목에서는 해당 노드에서 실행 중인 포드들의 자원
    할당량을 확인할 수 있다. 방금 생성한 resource-limit-pod라는 이름의 포드 외에도 kube-system 네임스페이스의 포드가 미리 존재하고 있을 것이다.
    이 포드들은 쿠버네티스의 네트워크를 위한 핵심 컴포넌트로, 따로 설정하지 않아도 기본적으로 CPU와 메모리가 할당된다.
```