## SSL
### 인증서의 구조
```text
    1. (널리 알려진) 신뢰 가능한 기관
    
    > 개요 
    
    무조건 신뢰할 수 있는 기관이 존재하며, 이를 보통 최상위 인증 기관이라고 부른다. Root CA라는 인증서를 발급하는 기관이다. 
    EX) Verisign, Geotrust 등이 그러한 기관이다. 
    이 기관들은 본인들만의 고유한 비밀키를 가지고 있고, 이에 대응하는 공개 키를 전세계에 배포한다. 그리고 세상 사람들은 암묵적으로 이 기관들은
    신용할 수 있음을 서로 약속하고, 최상위 기관이 제공한 공개키로 복호화가 가능한 데이터는 최상위 기관의 비밀키로 암호화 됐기 때문에
    신용할 수 있는 데이터라고 간주한다. 


    > 일반적인 인증서의 작동 방식
    
        > 인증서의 내용물 
            상대방이 신뢰할 수 있는지 검증하기 위해서 존재하는 '인증서'라는 포맷의 파일에는 아래와 같은 내용물들이 담겨있다.
            
            1) 인증서의 소유자 이름
            2) 인증서 소유자의 공개키 
            3) 인증서의 유효 기간
            4) UID
            5) 인증서의 기타 값을 해시화한 값 ( 인증서의 내용을 종합해 해시화한 값을 암호화한 값)
        
        > 인증서의 구조
            인증서는 계층구조로 되어있다. 보통 3계층 구조로 되어있고, 가장 최상위 기관이 발급한 인증서를 'Root'라고 부른다. 이러한 인증서는
            일반적으로 웹브라우저 등이 미리 내장되어 있으며, 해당 인증서에 대응하는 공개 키 또한 인증서 내부에 포함되어 있다. 
            
             ----- Root
             
            이러한 인증서를 기반으로 새로운 인증서를 만들 수 있다. 인증서의 내용물을 제공하고 이를 종합해 해시화한 값을 최상위 기관의 비밀
            키로 암호화 받는다. 이러한 경우 신뢰할 수 있는 인증서로 인증서를 만들었으므로 새로 만든 인증서 역시 신뢰가능하다고 간주할 수 있다.
            이러한 원리를 'Chain of Trust'라고 한다. 
            
            여기서 궁금한 점이 있다. 왜 굳이 이러한 일을 하는가? 사람드링 모두 갖고 있는 최상위 기관의 공개 키를 이용해 하위 인증서의 암호화
            된 해시값을 복호화 했고, 하위 인증서를 생성할 당시 사용한 해시 값을 얻었다고 가정해보자 여기까지 보면 어쨌든 이 하위 기관 인증서
            는 신뢰가능하다고 생각할 수 있다. 그런데
            
                1. 복호화된 해시값
                2. 인증서에 들어있는 내용물
                
            을 다시 해시 값으로 만들어 비교해보니 동일한 값이 아니라면 어떨까? 이는 곧 하위 인증서 내용물이 누군가에게 변조되었음을 뜻한다.
            따라서 상위 기관의 공개키로 하위 기관의 해시 값을 복호화 한다는 것은 1. Chain of Trust 원리에 의해 하위 인증서가 신뢰할 수 
            있는지를 알 수 있으며, 2) 하위 인증서의 내용물이 변조되었는지를 알수 있게 된다. 
            
            실제로 웹 브라우저에는 최상위 기관 인증서가 신뢰할 수 있도록 미리 등록 되어있다. 최상위 기관과 중간 인증서 기관까지는 사실상
            신뢰할 수 있도록 설정되어 있기 때문에 우리가 최상위, 중간 기관에 대해 실질적으로 의심할 필요는 없다. 즉 중간 인증서 기관은 
            모두 신뢰할 수 있으며 Root CA인증서와 구분짓기 위해서 ICA(Intermediate CA)라고 부른다. ICA 또한 일반적으로 신용도가 높은 
            회사로 구성되어 있기 떄문에 신뢰할 수 있는 인증서 목록에 기본적으로 등록되어 있다. 
            
            ---- chain
            
            그렇다면 이번에는 중간 기관이 상위가 되는 경우를 살펴보자 개인이 인증서를 발급받으려면 일반적으로 Root 인증서가 아닌 ICA에 
            인증서 사인(인증서 내용물 해시값과 암호화)를 요청하게 된다. 개인이 중간 기관에 인증서 생성을 요청하면 중간 기관은 중간 기관의 
            비밀키를 이용해서 해시값을 암호화함으로써 인증서에 서명하게 된다. 우리는 중간 기관이 신뢰할 수 있는 기관임을 최상위 기관의 공개
            키로 검증했다. 그런데 중간 기관의 공개 키를 통해 개인 인증서에 내장된 암호화된 해시 값에 복호화에 성공했다면 개인 인증서 또한 
            중간 기관에 의해 신뢰할 수 있음을 인증하게 된다. 
            
            여기서 다시 왜 ICA라는 중간 단계가 존재하는 것일까? Root CA가 개인 인증서까지 서명하면 조금 더 직관적이고 쉬운 구조인데 말이다.
            이에 대한 답변으로 인증을 수행하는 기관의 인증서가 손상되거나 비밀키가 유출될 경우 이를 철회(revoke)할 수 있도록 ICA라는 
            중간 단계를 두었다고 한다. 
            
            
            ??......
```
